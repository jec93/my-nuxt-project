datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(uuid())
  loginId   String   @unique
  password  String
  role      String   @default("USER")
  createdAt DateTime @default(now())
}

model Menu {
  screenKey String  @id
  parentKey String?
  label     String

  // 선택
  url       String?
  domain    String?

  // 운영/정렬
  depth     Int
  order     Int
  isActive  Boolean @default(true)

  // 관계
  parent   Menu?  @relation("MenuTree", fields: [parentKey], references: [screenKey], onDelete: SetNull)
  children Menu[] @relation("MenuTree")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([parentKey, order])
  @@index([depth])
}

model WorkItem {
  id        BigInt   @id @default(autoincrement())
  domain    String   @db.VarChar(80) // menu의 domain과 매칭
  title     String   @db.VarChar(200)
  status    String   @db.VarChar(20) // 대기/진행/완료
  owner     String?  @db.VarChar(50)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([domain])
  @@index([status])
  @@index([createdAt])
}